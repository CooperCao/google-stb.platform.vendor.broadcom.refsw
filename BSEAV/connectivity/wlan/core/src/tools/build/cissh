#
# $Id: expectssh,v 12.6 2010-10-27 20:49:16 prakashd Exp $
#
# SVN: $HeadURL$
#
# get password from special file
set fd [ open /home/wlanswci/.restricted/passwd r]
set password [ read $fd ]
set timeout -1
# now connect to remote UNIX box with given script to execute
spawn /tools/bin/ssh wlanswci@[ lrange $argv 0 0 ] [ join [ lrange $argv 1 999 ] " " ]
set sp_id $spawn_id
# puts "sp_id = $sp_id"
match_max 100000
# Look for passwod prompt
expect "*?assword:*"
# Send password aka $password
send -- "$password\r"
# send blank line (\r) to make sure we get back to gui
send -- "\r"
set timeout 7200
expect eof

# cleanup
# puts " Exit status : [ exp_wait -i $sp_id ]"
catch {exp_close -i $sp_id}
