#!/bin/env utf
# -*-tcl-*-

# $Copyright Broadcom Corporation$
# $Id: 5d9fc9ba28483089e9c6be255a77186775414662 $
#

#
# UTF test script testing web page form
#

# This test simply updates a router's SSID via the web interface, then
# verifies that the nvram, the web page and the driver all notice the
# change.
#


package require UTF

UTF::Test WebForm {AP}  {

    # Generate an SSID for the test
    set SSID [UTF::NewSSID]

    # Remember to specify wireless unit when setting wireless params
    UTF::Assert -r [$AP http apply wireless.asp [list wl_ssid $SSID]] \
	"Validating values...done" $AP "Update form"
    UTF::Sleep 5 "Wait for restart"

    # Fetch parameter set
    array set params [$AP http getform "wireless.asp"]

    UTF::Assert $params(wl_ssid) $SSID $AP "Verify ssid in form"

    UTF::Assert [$AP nvram get wl0_ssid] $SSID $AP "Verify ssid in nvram"

    UTF::Assert [$AP wl ssid] $SSID $AP "Verify ssid in effect"

}
