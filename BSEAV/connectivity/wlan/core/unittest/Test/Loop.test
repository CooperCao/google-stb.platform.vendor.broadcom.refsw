#!/bin/env utf
# -*-tcl-*-

#
# Run One test repeatedly
#
# Usage: Loop [-try] n Test args
#

package require UTF

UTF::Test Loop {n Test args} {

    if {$n eq "-try"} {
	# If first arg is -try, change wrapper and shift args up.
	set wrap "UTF::Try"
	set n $Test
	set Test [lindex $args 0]
	set args [lreplace $args 0 0]
    } else {
	set wrap "UTF::Record"
    }

    # Allow user to specify either the TCL name or the shell path for
    # the test.
    regsub {\.test} $Test {} Test
    regsub -all {/} $Test {::} Test
    regsub {^Test::} $Test {UTF::Test::} Test

    package require $Test
    while {$n} {
	$wrap {} {
	    eval $Test $args
	}
	incr n -1
    }
}
