#!/bin/env utf
# -*-tcl-*-

#
# UTF test script for testing up/down cycles in monitor mode
# $Id: 679eda01b5814c21588720176430b6e4edfacc9c $
#

package require UTF
package provide UTF::Test::Rexectimeout 0.1

UTF::Test Rexectimeout {STA1} {

    set cmd "time {\
    echo 1 1; sleep 1;\
    echo 2 3; sleep 2;\
    echo 3 6; sleep 3;\
    echo 4 10; sleep 4;\
    echo 5 15; sleep 5;\
    echo 6 21; sleep 6;\
    echo 7 28; sleep 7;\
}"

    UTF::Try "IO Timer" {
	catch {$STA1 rexec -t 4 $cmd} ret
	if {![regexp {5 15\n(:?child|Timeout)} $ret]} {
	    error "$ret"
	}
    }
    UTF::Try "Command timer" {
	catch {$STA1 rexec -t 11 -T 11 $cmd} ret
	if {![regexp {5 15\n(:?child|Timeout)} $ret]} {
	    error "$ret"
	}
    }
}

