#!/bin/env utf
# -*-tcl-*-

# UTF test script for testing the moving of interfaces between bridges
# on a router

# $Id: f7e5319d3bc9527e5b56234231f6da2fbe15b68e $
#
# Usage: DisassocOnRemoval AP STAs
#
# During the test each STA in the list STAs is associated with AP.
# The interface AP is disabled on the router, which should cause the
# STAs to be disassociated.

package require UTF
package require UTF::Test::Mbss::APAddInterface
package require UTF::Test::Mbss::APRemoveInterface
package require UTF::Test::ConnectAPSTA

package provide UTF::Test::Mbss::DisassocOnRemoval 2.0

UTF::Test Mbss::DisassocOnRemoval.test {AP STAs} {

    APAddInterface $AP

    UTF::Test::ConnectAPSTA $AP $STAs -security open

    APRemoveInterface $AP

    UTF::Sleep 5

    foreach STA $STAs {
	UTF::Assert [$STA wl bssid] "00:00:00:00:00:00" $STA "Not Associated"
	$STA wl disassoc
    }
}
